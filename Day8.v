From Coq Require Import Lists.List.
From Coq Require Import BinNums.
From Coq Require Import ZArith.BinInt.
From Coq Require Import ZArith.BinIntDef.
From Coq Require Import ZArith.Zdigits.
From Coq Require Import ZArith.Znat.
From Coq Require Import ZArith Psatz.
From Coq Require Import PeanoNat.
Import ListNotations.

Open Scope N_scope.
Definition test_in := [
[3;0;3;7;3];
[2;5;5;1;2];
[6;5;3;3;2];
[3;3;5;4;9];
[3;5;3;9;0]
].
Definition input := [
[2;3;3;2;2;1;3;0;1;1;0;3;0;1;4;0;3;0;1;0;1;1;2;5;5;5;4;3;0;4;5;1;2;4;5;0;1;0;1;0;1;4;4;1;6;5;6;3;0;1;6;6;1;4;5;4;4;4;5;1;2;1;1;5;0;3;5;5;1;0;1;2;0;2;4;5;3;0;3;0;1;0;3;1;1;2;3;4;1;1;3;0;3;0;1;2;0;2;3];
[2;2;3;1;1;0;0;3;0;3;1;2;0;3;2;0;0;4;3;1;5;2;3;2;0;2;0;0;2;1;0;4;4;3;5;1;2;2;6;5;6;6;0;5;3;5;2;5;5;2;0;0;1;4;1;6;1;0;1;4;3;6;5;1;3;3;5;2;4;2;4;1;0;5;2;5;0;5;3;1;0;0;2;0;0;4;0;4;3;0;1;4;0;2;3;3;2;3;3];
[0;1;1;2;0;0;3;0;2;4;2;3;4;2;1;4;0;2;5;3;4;3;0;2;3;5;0;0;4;2;3;1;3;1;5;4;0;6;5;5;1;4;5;2;5;5;6;5;2;2;5;3;0;6;3;3;5;6;0;2;4;3;2;3;3;2;2;4;1;1;5;1;0;1;5;2;4;2;0;2;4;2;0;0;4;0;2;1;4;0;1;3;3;2;2;0;0;0;3];
[0;0;2;0;2;3;3;2;3;1;4;4;3;0;3;0;4;5;3;5;0;5;1;4;5;5;1;4;4;0;1;1;5;5;3;1;3;5;6;5;1;2;2;5;2;0;2;6;6;2;5;4;4;0;3;5;5;2;5;0;2;2;6;3;3;3;2;2;4;2;1;4;3;4;3;2;3;1;5;0;0;1;2;4;3;1;2;3;4;0;3;3;4;3;4;1;3;2;1];
[1;0;1;2;3;2;2;4;3;1;4;0;3;1;2;0;2;4;1;4;2;3;2;0;2;0;4;2;1;4;2;4;4;4;6;4;2;3;1;2;3;0;0;6;2;3;5;4;0;1;6;6;5;2;1;3;6;6;5;3;2;4;0;5;1;3;2;5;5;4;3;1;3;3;3;2;0;4;0;4;0;0;4;4;4;0;1;0;3;0;4;3;4;2;1;1;0;3;0];
[3;0;3;1;0;2;4;1;3;1;0;2;4;3;5;3;1;1;5;3;2;0;5;2;5;5;5;5;5;3;0;3;1;0;4;0;4;6;1;0;1;0;4;1;6;5;2;0;3;5;4;4;0;4;0;0;0;2;0;2;1;0;1;1;2;5;2;4;0;0;5;6;1;3;1;2;1;5;0;1;1;3;5;2;3;3;4;2;0;0;0;3;2;4;3;4;2;2;3];
[3;0;0;2;4;1;1;2;4;0;2;1;3;5;0;4;4;0;2;3;5;3;0;5;3;0;5;2;6;5;0;6;4;5;0;2;2;5;2;6;6;4;3;5;5;6;5;3;0;5;2;6;0;3;1;0;3;6;6;1;0;2;2;3;3;5;1;5;4;6;5;4;3;5;0;2;2;0;2;5;3;3;4;3;5;3;5;4;1;1;2;2;3;3;3;4;1;2;3];
[3;2;3;2;2;0;2;4;3;3;2;2;0;4;4;3;1;3;5;5;4;1;1;4;2;1;0;1;4;5;1;5;6;0;0;5;4;4;1;0;0;1;5;2;0;3;5;3;5;6;3;7;5;4;3;3;0;3;4;2;2;1;2;5;1;6;6;2;5;2;4;2;3;4;1;1;5;1;0;2;4;2;1;3;3;3;5;0;4;1;4;1;4;3;4;2;2;0;1];
[1;3;0;0;1;3;2;1;4;2;4;4;2;4;3;2;1;3;5;0;2;2;2;0;2;1;6;3;2;4;3;6;3;5;3;5;1;1;0;1;3;5;4;1;2;1;2;6;7;2;1;4;2;6;7;1;1;5;7;5;5;3;5;5;6;6;0;5;0;2;2;2;1;6;0;0;4;0;0;1;0;5;3;3;4;5;2;0;3;5;3;3;2;0;4;3;1;2;2];
[3;3;1;2;2;3;0;4;2;3;3;4;2;4;4;5;5;0;5;0;4;5;5;1;6;0;5;4;3;4;2;5;2;6;6;6;2;6;6;3;5;4;2;3;2;4;6;1;5;2;6;2;5;3;2;2;5;2;3;4;2;7;7;3;0;3;6;2;3;5;5;3;3;5;2;6;0;5;0;2;2;4;2;4;4;5;1;3;0;0;4;4;2;4;0;4;2;4;4];
[1;4;3;2;4;4;0;1;1;3;0;2;2;4;2;5;5;0;0;4;0;2;2;2;1;2;6;5;2;6;0;0;5;5;3;3;5;2;6;3;4;4;7;7;3;2;4;7;7;3;1;4;4;2;7;6;6;3;1;2;6;6;2;4;5;2;5;4;2;6;4;1;1;0;1;6;0;4;6;5;5;5;4;3;1;3;4;1;4;1;2;3;0;4;4;1;3;3;2];
[0;3;4;2;2;3;2;2;3;3;4;1;1;4;0;1;4;0;5;3;2;4;4;0;6;2;2;1;0;0;2;4;4;2;7;6;2;2;4;7;7;2;5;1;3;4;3;3;3;5;4;2;7;7;5;2;5;7;3;6;1;3;6;6;1;6;6;2;4;5;3;3;1;2;5;0;6;2;1;6;4;1;1;3;4;5;4;0;2;5;4;0;3;4;2;3;4;0;2];
[0;1;1;1;1;2;4;2;1;3;3;1;1;2;5;4;4;4;5;4;1;5;4;5;2;2;3;1;1;6;7;4;3;7;3;5;2;1;5;1;2;5;7;3;1;3;3;4;7;2;7;6;4;2;3;6;6;1;5;1;1;3;1;7;5;3;3;5;5;1;2;0;2;2;3;0;6;4;0;2;4;6;1;5;4;1;0;2;3;5;0;0;2;3;3;0;0;4;4];
[4;4;4;0;1;0;4;1;5;2;5;1;3;3;3;3;6;0;4;2;4;2;2;6;0;5;4;3;2;5;5;2;5;1;3;4;3;5;6;2;6;1;3;5;2;6;2;7;7;5;6;1;4;2;6;3;5;2;4;6;2;7;7;1;3;4;7;6;7;6;7;5;1;4;4;6;6;2;5;0;6;3;6;5;5;4;1;4;2;4;2;1;5;0;1;1;3;3;1];
[4;1;3;3;3;2;4;4;1;2;5;2;4;1;2;1;1;4;0;2;4;4;0;4;0;0;2;4;5;5;1;7;5;4;6;4;5;5;1;2;2;6;7;2;2;7;2;3;7;8;7;4;6;7;1;3;6;5;2;2;7;2;3;6;7;5;7;1;6;5;2;6;6;7;7;6;2;1;4;0;0;4;0;5;1;4;5;4;0;4;0;4;4;3;5;3;2;2;4];
[3;2;0;0;2;3;2;3;1;4;4;5;5;2;3;6;6;5;5;4;6;4;2;6;4;4;3;7;1;3;5;6;1;7;2;6;2;7;6;4;7;1;6;8;5;7;3;6;8;4;6;4;7;6;6;5;6;8;6;4;4;2;7;6;2;1;2;7;6;5;6;6;2;6;7;6;4;1;1;5;2;2;6;3;1;5;2;4;3;4;5;5;1;4;2;3;1;4;2];
[4;2;2;0;3;2;3;4;0;1;5;0;0;5;3;0;1;6;4;3;4;5;0;5;3;1;5;2;3;4;1;5;7;3;3;3;7;1;6;3;6;3;5;7;3;8;6;8;4;5;7;3;3;4;7;8;8;3;3;2;5;2;5;1;5;7;4;2;6;1;4;3;5;3;2;1;2;5;0;6;0;0;0;4;4;1;4;2;0;2;2;1;4;3;2;3;5;4;1];
[2;4;2;0;0;5;5;2;3;1;3;0;1;0;0;1;5;6;4;6;6;6;0;5;1;2;2;4;4;6;7;2;4;6;3;7;2;4;5;5;4;7;2;5;6;7;6;7;5;3;4;5;3;6;3;7;7;3;8;4;6;6;3;6;8;6;2;6;5;1;6;5;3;1;4;7;2;6;5;4;2;3;4;4;2;6;0;1;4;0;1;3;5;4;5;4;0;0;2];
[1;0;3;1;0;3;1;0;0;3;3;3;0;4;5;1;3;4;5;4;3;3;4;2;6;4;7;7;1;5;3;6;3;3;4;6;7;2;2;7;2;7;4;7;2;3;4;5;7;6;2;3;3;8;5;6;4;5;4;4;7;2;8;6;8;3;8;1;7;7;4;2;2;2;2;6;6;3;4;3;5;1;6;1;4;5;2;4;1;1;3;1;4;3;4;2;3;3;1];
[2;0;1;0;3;0;5;3;1;4;5;5;6;1;2;5;6;3;2;1;4;1;3;6;7;1;6;4;2;1;6;7;4;2;6;5;2;7;3;6;8;5;2;4;6;2;3;2;7;7;4;7;8;7;7;5;8;4;4;4;8;8;2;7;5;8;6;3;2;6;2;3;2;7;1;2;3;2;5;4;4;6;4;5;0;2;6;6;5;5;1;3;0;0;5;0;0;1;5];
[2;0;2;4;1;0;2;1;4;1;5;2;6;3;4;6;0;4;6;3;2;2;4;2;2;5;7;7;2;5;8;4;3;7;8;2;4;6;8;4;6;2;4;8;7;5;3;4;8;8;6;8;4;4;2;4;2;3;2;6;8;4;2;6;3;2;5;6;5;7;4;6;6;1;6;6;5;6;4;3;3;1;4;0;4;3;3;3;3;5;2;4;3;5;3;1;3;3;3];
[4;1;1;5;0;4;0;5;4;6;1;3;0;6;3;2;5;1;4;2;5;6;7;2;1;3;1;2;6;7;4;6;6;6;6;5;3;5;2;5;4;7;3;4;5;3;4;6;7;7;3;8;8;3;3;4;4;3;7;7;2;3;7;2;5;5;8;7;4;7;8;2;3;6;6;3;7;5;3;6;2;4;3;4;6;2;4;6;6;0;0;5;1;3;5;4;3;0;2];
[3;3;2;3;3;4;0;5;1;6;6;0;4;3;2;4;2;4;3;6;5;5;3;4;6;6;4;4;3;8;2;5;7;2;2;5;3;5;2;5;6;6;4;4;8;4;6;4;7;6;8;6;4;7;7;4;9;8;4;2;8;3;3;8;6;2;3;6;6;5;2;7;5;2;5;7;3;7;5;6;3;3;1;0;4;5;0;1;5;4;2;2;2;2;1;2;2;0;1];
[5;5;4;5;5;1;2;3;2;1;6;2;0;2;3;6;5;2;3;7;7;4;1;5;6;1;7;5;7;6;3;2;6;4;2;6;6;3;4;3;3;4;4;8;6;4;3;9;8;3;4;9;5;6;7;4;9;7;8;9;8;6;2;2;7;7;6;5;7;7;8;3;2;4;6;6;7;2;6;7;7;3;1;2;1;3;5;3;2;5;0;2;1;1;2;5;4;0;0];
[2;1;5;4;1;5;4;6;2;4;5;3;1;6;5;5;3;4;7;1;5;4;7;4;4;3;5;3;4;5;6;7;7;3;2;6;6;2;3;9;4;4;3;6;8;5;8;7;7;8;6;4;4;8;4;6;3;7;3;3;9;3;8;4;2;2;3;2;5;3;7;7;2;4;7;2;5;3;1;4;2;6;2;5;7;6;6;1;6;6;4;4;1;1;2;4;2;4;0];
[1;5;2;5;2;0;0;4;2;4;4;5;4;2;0;4;2;6;2;7;1;1;6;4;1;5;6;2;2;4;2;3;2;5;5;8;9;9;5;3;9;4;3;8;9;9;7;9;4;4;7;7;9;6;5;6;4;9;6;8;4;3;6;4;9;6;7;8;3;7;4;2;3;7;4;5;3;7;1;4;4;2;6;6;7;5;4;1;4;5;6;6;5;1;3;3;5;5;1];
[3;1;0;3;4;3;4;0;6;5;3;6;2;6;1;7;4;5;7;3;2;6;6;3;8;7;7;4;3;4;3;5;7;7;6;3;8;9;7;6;5;7;7;5;7;4;8;3;5;6;7;9;9;8;9;5;5;3;3;3;7;3;5;4;8;5;7;3;2;7;4;3;6;8;5;6;4;2;1;6;7;7;1;3;4;6;1;5;0;3;2;4;1;4;1;0;4;1;3];
[4;1;5;4;4;4;1;0;0;1;5;6;2;6;5;2;6;3;6;6;1;4;1;2;8;5;7;4;3;4;7;2;6;8;3;7;3;9;4;4;7;3;4;8;8;9;6;8;6;9;9;8;3;8;7;4;9;5;7;8;9;3;8;8;3;7;9;6;8;8;4;7;3;8;3;4;3;2;2;2;6;3;7;4;6;1;7;6;1;0;2;2;0;6;0;1;1;3;1];
[0;4;4;0;0;0;2;6;2;6;5;0;3;7;2;4;1;3;5;5;5;4;7;2;5;7;2;7;6;4;4;8;8;3;6;6;3;5;3;8;7;7;5;8;7;3;3;4;5;5;5;9;6;8;7;4;5;3;8;3;8;3;7;5;4;3;9;3;5;4;4;7;8;8;3;3;2;3;4;1;2;3;3;4;7;7;6;2;5;5;3;3;4;2;0;1;4;3;4];
[3;3;1;4;1;6;6;4;1;5;6;2;1;7;4;5;5;1;3;1;7;7;7;8;7;6;8;4;8;6;7;8;3;5;5;5;6;7;6;6;3;4;5;4;8;6;7;7;9;6;6;8;9;4;4;4;8;8;7;8;4;9;9;7;8;3;9;4;8;6;8;8;8;7;8;4;7;8;2;7;3;1;6;4;2;1;6;5;6;5;4;5;6;6;2;2;4;3;2];
[5;4;2;2;6;4;1;1;5;5;1;2;4;3;4;2;3;3;2;7;2;3;4;3;8;4;8;4;7;8;7;4;8;5;6;7;3;8;3;8;7;5;6;6;8;7;9;7;5;9;7;7;6;9;8;7;5;5;9;8;6;9;9;6;3;5;8;4;5;6;8;2;7;2;7;4;2;2;6;8;4;6;5;6;4;2;5;3;6;3;4;2;3;2;5;4;0;4;3];
[5;5;1;3;5;5;0;5;0;4;4;3;3;3;1;3;2;7;3;5;8;3;4;3;7;2;4;7;4;6;5;5;3;8;4;9;3;5;7;4;7;6;9;7;9;6;8;6;8;4;4;4;8;8;9;5;4;8;8;9;8;4;9;5;3;9;8;3;9;3;4;5;6;6;8;3;3;5;6;2;4;5;3;1;4;1;1;1;6;6;0;1;4;4;0;6;0;0;4];
[4;4;0;1;1;0;1;2;4;3;1;2;1;6;3;3;7;3;4;4;2;4;7;8;4;7;5;5;3;9;6;3;5;6;8;6;7;9;5;9;8;7;5;7;5;5;5;4;6;8;7;8;9;7;6;4;5;4;9;8;6;5;9;5;4;9;9;9;8;6;5;3;6;4;5;8;4;8;8;6;6;8;5;5;1;4;3;4;1;7;4;1;1;2;2;1;6;1;2];
[4;5;2;4;1;6;6;6;1;0;4;4;3;7;6;7;5;4;5;5;3;5;3;6;3;8;4;4;4;3;5;3;7;3;6;7;4;4;9;9;9;7;6;8;9;7;6;8;5;5;5;6;9;5;7;7;8;8;4;8;5;8;7;8;5;9;6;4;6;7;6;3;6;6;6;7;8;7;2;6;7;3;5;5;1;1;3;3;7;6;6;5;2;0;3;2;4;0;3];
[3;5;1;6;5;0;1;0;6;6;1;2;7;3;3;6;4;3;5;6;7;2;3;4;4;7;9;5;6;7;8;3;8;5;7;4;5;4;5;7;4;8;5;4;7;6;5;4;9;5;9;7;4;8;8;9;8;4;9;6;7;8;7;9;7;8;8;5;7;4;4;8;3;8;7;8;3;8;5;5;6;7;6;1;3;1;1;4;3;4;6;2;1;1;6;1;6;0;0];
[4;2;3;1;6;4;2;1;5;4;5;2;4;2;6;7;7;5;3;4;6;8;7;3;5;2;8;8;9;3;4;8;8;4;9;9;8;5;9;7;4;8;4;8;6;7;9;7;9;6;4;6;6;8;7;8;4;8;6;8;7;8;7;9;5;9;5;7;8;5;5;3;9;6;5;5;3;6;5;7;6;7;3;3;1;1;5;2;3;2;4;1;2;1;5;0;3;5;0];
[5;3;4;5;2;0;3;4;5;5;5;5;1;4;6;7;6;3;2;3;6;6;3;3;7;3;5;7;9;8;3;4;7;4;4;8;8;7;7;5;9;9;6;7;4;6;5;5;9;7;8;7;9;5;9;7;4;7;8;6;5;6;9;6;6;6;4;4;4;7;4;9;4;7;7;5;5;7;5;7;6;2;2;5;7;2;1;3;7;1;3;2;6;5;5;5;4;5;4];
[0;1;5;0;1;2;0;4;1;5;3;3;6;4;2;3;3;3;2;6;2;6;3;8;4;5;6;5;5;3;6;6;7;9;7;7;6;6;4;6;5;9;4;8;6;9;9;7;6;6;5;8;6;7;5;5;6;8;9;5;5;8;7;6;4;5;7;9;5;8;6;4;8;9;6;9;2;3;4;5;8;2;2;2;1;2;3;7;1;6;5;4;6;1;0;4;6;0;4];
[5;4;1;3;1;4;5;4;3;7;1;7;4;4;1;1;3;4;7;6;8;3;3;4;4;3;8;4;3;6;3;9;8;5;7;5;6;7;4;4;9;9;7;8;8;8;6;7;8;5;8;8;7;9;9;5;8;9;9;4;5;6;7;8;6;5;6;5;7;9;5;8;7;9;9;9;6;5;4;6;7;2;6;5;8;2;2;7;5;3;4;4;4;3;0;5;1;3;0];
[1;0;4;1;5;0;4;3;4;7;5;1;2;3;4;1;6;4;2;5;5;8;3;6;3;3;9;3;6;3;6;8;8;6;7;5;6;6;7;4;7;9;8;8;9;8;9;6;7;9;8;5;5;7;6;5;8;6;6;8;9;7;4;4;9;4;5;8;7;4;5;3;9;4;7;3;3;7;2;3;5;8;3;4;4;4;6;6;4;4;2;3;4;1;0;4;2;6;3];
[4;4;1;4;2;0;2;4;3;1;1;1;1;3;7;5;5;7;5;6;8;7;4;9;4;9;4;9;9;5;7;7;4;8;7;9;4;8;7;5;9;7;5;8;8;9;6;8;8;8;9;5;9;5;7;5;9;9;7;8;5;4;9;7;8;8;6;4;8;6;9;5;7;5;7;6;8;4;6;3;4;2;2;3;4;1;6;6;5;6;4;6;2;6;4;5;0;0;3];
[1;0;3;1;2;5;1;5;5;2;2;4;7;2;7;1;7;2;8;4;4;5;7;4;9;9;3;8;4;3;9;5;5;8;4;8;6;5;7;5;6;6;5;7;7;7;9;6;6;7;5;5;8;6;5;6;6;7;8;9;6;8;6;6;4;9;6;6;5;8;7;9;6;5;5;9;5;7;8;3;8;5;5;4;3;2;2;3;5;4;6;1;2;5;5;2;4;2;4];
[5;0;5;0;0;4;5;1;5;2;7;2;4;5;5;8;5;6;6;6;8;6;2;3;7;3;7;7;9;6;9;8;9;4;6;8;4;5;8;8;5;6;9;6;6;9;5;6;6;9;8;7;5;8;9;7;8;8;6;6;9;5;7;4;6;7;8;6;4;6;5;3;3;6;9;3;5;8;6;6;3;8;2;5;7;8;6;7;7;4;3;5;4;3;2;3;0;3;4];
[3;2;6;0;3;3;6;5;4;5;7;4;7;7;4;3;6;6;3;8;5;2;8;8;8;7;6;6;3;4;6;4;9;4;7;9;7;9;7;7;9;5;5;6;7;7;7;9;7;9;6;6;6;5;8;9;6;9;5;5;7;7;6;4;8;8;6;8;6;5;7;4;4;5;8;9;3;5;6;2;7;6;8;5;4;8;3;4;5;6;5;4;7;5;0;6;4;3;2];
[5;6;2;1;0;3;3;2;4;5;4;3;7;4;4;3;2;4;3;6;5;3;4;6;4;5;3;4;6;8;6;4;8;5;5;8;5;9;7;6;5;7;5;9;9;5;8;8;6;9;8;6;9;6;9;9;9;8;8;5;5;9;5;9;6;8;9;7;6;9;7;8;7;9;4;9;3;7;4;6;4;4;5;6;5;8;1;4;3;2;6;1;3;1;4;0;1;3;6];
[6;1;2;3;4;5;4;2;4;4;4;6;1;7;2;7;3;3;2;8;5;6;9;9;7;8;7;3;7;4;5;6;7;8;7;4;5;9;8;6;7;8;6;8;5;6;8;8;6;8;6;6;8;7;6;8;8;7;6;7;5;8;8;5;8;5;4;5;7;5;4;5;5;8;7;5;5;5;9;4;7;5;2;7;2;8;6;5;5;5;3;1;1;0;5;0;0;0;0];
[4;3;3;4;1;1;4;1;4;6;2;6;3;7;6;5;4;3;2;4;4;2;4;4;8;6;7;9;8;7;4;8;4;9;4;8;5;8;7;6;7;8;6;5;8;9;6;6;7;6;6;7;8;9;7;9;6;8;7;7;8;5;5;6;9;8;4;6;7;4;4;7;8;5;9;5;6;3;3;5;7;8;8;3;4;8;5;3;7;5;4;7;5;4;0;6;3;5;4];
[3;4;1;2;5;3;4;5;1;3;3;4;1;2;5;8;7;5;2;4;5;3;7;3;6;8;5;5;6;4;9;5;5;8;8;7;5;8;9;9;6;6;8;6;6;9;8;9;9;9;9;9;9;7;7;9;7;5;9;8;9;7;8;9;7;4;4;7;5;4;6;8;5;9;4;8;5;7;4;8;4;2;5;8;4;8;4;1;3;6;1;2;7;1;2;0;1;0;0];
[2;0;0;3;0;3;4;3;3;7;3;5;7;4;5;2;3;7;7;6;6;7;4;7;8;3;4;5;4;4;6;5;8;6;9;6;9;9;9;6;8;6;7;9;9;7;6;8;6;8;6;7;8;6;8;7;9;8;8;7;8;7;5;6;6;4;6;5;7;7;5;8;3;5;9;5;4;9;9;3;7;2;8;2;8;3;8;2;4;7;6;2;6;2;3;1;0;5;6];
[6;5;4;6;4;6;3;3;6;6;4;4;1;5;8;8;8;3;6;8;4;2;8;5;8;4;6;7;3;4;6;9;5;9;6;9;5;8;5;5;5;8;7;6;6;7;9;9;6;7;9;8;8;8;6;7;7;8;9;9;8;7;7;6;9;7;9;9;4;7;4;6;7;6;8;6;8;5;7;5;8;8;8;5;4;2;5;7;5;3;3;1;1;2;6;1;3;0;6];
[2;0;1;0;3;6;0;3;4;4;5;2;1;2;8;3;7;2;7;6;3;2;3;9;7;6;3;5;8;5;6;5;7;6;9;7;7;6;7;6;6;8;9;9;9;9;9;6;8;8;7;9;7;8;7;6;6;9;8;7;7;9;6;7;5;4;9;6;9;4;9;4;9;7;8;7;5;5;3;7;2;8;5;8;4;3;3;1;1;5;1;3;1;3;3;4;0;2;5];
[4;6;2;0;6;0;5;5;6;4;4;5;6;2;7;7;5;3;5;3;5;8;9;3;4;9;5;3;7;7;6;4;9;8;7;8;7;6;6;6;5;5;9;8;8;7;9;8;9;7;7;9;9;7;6;8;7;7;8;9;8;5;6;6;5;8;4;7;4;7;4;7;6;6;8;8;6;8;4;4;4;5;6;8;5;4;5;6;4;3;7;1;4;4;3;1;0;6;6];
[1;4;0;2;5;4;5;3;4;6;1;2;1;2;4;5;8;8;7;4;5;6;6;9;7;3;3;3;8;4;6;8;6;6;6;9;6;5;5;6;5;9;5;5;6;9;6;9;6;8;7;6;6;9;6;8;6;6;9;7;5;6;5;5;9;4;7;8;4;8;9;6;4;5;4;7;5;7;7;2;3;7;2;3;4;2;4;3;7;7;5;7;4;2;5;3;6;1;1];
[6;6;3;5;1;6;3;7;1;6;4;6;2;4;4;4;5;4;8;5;3;4;5;6;8;9;4;5;9;5;4;9;7;9;4;4;5;8;6;6;6;5;9;7;7;8;9;9;9;8;7;8;8;8;7;9;8;5;8;8;7;6;8;9;6;5;4;7;7;8;4;6;9;7;4;9;8;7;5;6;2;7;4;7;6;4;4;1;5;3;7;5;7;5;1;3;1;4;1];
[3;3;2;4;5;2;3;1;5;2;3;3;6;1;6;3;2;8;5;2;2;2;9;7;9;3;8;8;7;8;5;6;4;8;9;9;9;6;8;6;6;7;8;5;7;8;8;6;9;7;6;6;8;7;6;8;8;7;8;7;7;5;6;7;6;7;8;6;5;4;4;9;9;8;6;7;9;7;7;6;5;8;2;7;5;2;6;2;1;5;3;4;6;7;0;0;5;1;0];
[4;5;2;6;4;5;1;5;5;5;4;2;5;5;3;7;5;5;7;2;2;7;3;7;5;7;6;4;3;7;9;6;6;9;5;9;8;7;6;6;6;9;8;5;7;8;7;9;7;8;9;6;7;9;6;7;9;7;8;7;6;6;8;7;6;6;8;6;6;8;6;9;6;3;9;4;9;7;7;3;2;5;8;2;2;6;2;2;6;2;3;4;6;2;0;6;6;0;5];
[3;2;0;4;5;1;3;0;5;6;5;1;7;7;1;6;5;6;3;5;8;7;7;3;6;6;8;4;5;9;5;7;9;4;7;4;5;7;7;5;8;9;9;7;8;5;7;7;7;8;7;6;6;6;8;6;8;7;8;7;6;8;5;7;9;7;8;8;4;4;9;6;9;8;5;4;5;3;4;7;8;2;8;7;8;4;3;5;5;7;7;5;2;5;4;0;3;2;6];
[2;2;1;0;0;5;4;0;5;5;7;7;6;6;7;6;8;3;8;2;4;2;8;7;8;9;5;5;7;5;5;8;8;7;8;5;5;8;9;6;5;6;8;8;8;8;5;6;5;9;9;6;8;5;8;7;6;5;8;6;7;7;6;5;4;6;8;5;6;4;4;9;5;6;9;5;5;7;2;2;5;5;3;7;3;8;1;5;2;5;4;4;3;5;4;6;5;1;5];
[5;2;2;6;1;0;4;1;2;4;4;7;1;4;6;7;3;7;5;5;4;3;5;7;9;6;5;7;3;6;5;6;4;8;7;5;8;4;5;9;9;9;6;7;6;7;6;7;7;8;6;9;5;7;7;7;6;6;8;9;6;5;8;5;5;8;9;4;7;4;6;5;7;8;3;9;6;5;3;8;8;6;3;7;3;4;7;1;3;5;7;3;3;2;1;4;1;2;0];
[3;6;5;1;1;3;0;4;1;7;4;3;7;7;2;2;4;7;6;4;8;3;6;9;6;8;8;5;8;8;7;6;6;6;5;9;4;4;7;8;7;6;8;5;7;7;8;8;7;8;7;9;8;9;9;9;9;5;8;8;6;7;6;7;5;5;6;5;5;6;4;3;6;5;4;4;5;7;2;2;3;5;8;8;3;4;5;2;1;5;7;6;3;3;4;2;1;4;5];
[3;3;1;3;6;5;6;6;2;3;4;4;2;4;4;2;7;5;7;6;6;5;3;8;4;6;8;5;5;7;8;9;5;9;9;4;8;6;5;8;8;6;6;8;7;5;9;7;9;7;5;5;9;9;8;9;7;8;9;5;6;7;9;5;6;9;4;9;4;7;9;3;3;5;5;7;3;8;5;6;2;4;4;5;3;7;1;7;6;1;4;4;5;1;5;4;3;5;0];
[5;6;0;4;1;6;6;0;5;7;2;3;6;6;7;1;8;2;4;8;5;2;2;4;7;8;4;9;8;8;4;5;5;5;7;7;4;6;8;8;6;6;5;5;5;5;6;9;5;6;9;9;9;8;5;8;5;7;8;7;8;9;6;4;8;5;8;7;8;8;4;7;3;3;8;5;3;5;6;8;3;4;6;2;2;6;4;1;1;1;4;7;0;2;5;1;5;3;0];
[1;4;6;4;1;3;6;0;4;2;4;3;2;7;5;4;2;5;2;6;5;7;3;6;4;5;8;6;5;5;7;5;6;5;5;8;5;5;6;5;6;6;7;6;8;7;9;8;9;6;8;8;8;7;7;7;7;7;7;6;4;6;4;5;5;4;7;8;6;7;9;7;4;6;6;7;9;5;5;2;6;2;6;2;5;6;3;1;4;7;7;1;5;2;6;3;4;2;6];
[1;3;0;2;2;6;5;0;3;7;7;4;2;5;2;4;4;3;8;3;8;5;2;3;7;8;7;4;5;7;4;5;8;4;8;7;4;4;5;7;9;8;5;7;6;5;7;5;7;8;9;6;8;7;8;9;8;5;9;9;7;7;7;4;4;4;9;9;6;6;7;4;8;9;6;5;5;7;6;6;5;8;3;2;7;5;4;7;6;6;1;5;1;2;1;1;1;1;4];
[4;1;0;6;4;4;1;6;0;4;1;6;4;6;5;5;1;6;2;6;5;4;7;2;7;6;3;6;8;5;9;5;6;6;5;5;9;4;7;5;5;4;9;9;7;9;9;7;9;8;8;9;8;5;6;6;4;5;4;9;8;6;7;9;4;4;6;6;7;6;4;5;9;6;3;8;3;7;5;8;5;3;3;8;2;7;1;7;4;6;1;2;0;0;2;0;6;2;3];
[2;3;4;4;0;0;4;4;4;3;5;3;7;3;5;6;1;4;3;6;7;3;4;6;4;7;3;7;7;7;9;7;5;3;5;9;6;7;6;5;8;4;4;6;5;4;8;6;4;4;4;4;8;8;5;4;7;7;8;5;8;5;9;5;6;7;9;4;4;6;8;6;9;7;8;7;2;2;8;4;3;7;6;4;7;1;4;1;1;7;5;0;6;6;6;4;6;0;0];
[3;3;0;5;4;6;3;4;1;2;2;2;1;7;3;2;3;2;2;6;8;7;7;7;4;4;4;9;6;4;3;3;6;5;3;7;9;4;6;8;8;4;9;4;7;5;7;8;6;4;6;8;4;8;7;5;4;9;6;9;9;8;7;8;6;8;4;8;9;8;5;7;5;7;4;7;8;3;6;2;5;5;2;3;6;2;7;5;1;5;7;4;5;0;1;2;6;3;2];
[2;1;5;5;1;0;4;6;0;3;1;3;3;5;1;4;1;1;6;4;7;2;3;4;3;6;6;6;3;8;3;8;9;7;7;3;8;4;5;7;4;7;8;4;7;5;9;8;5;7;9;8;9;7;8;9;4;8;8;9;7;8;8;5;4;6;9;4;4;8;6;3;9;8;5;3;4;2;4;5;7;2;7;5;6;6;3;6;7;5;6;1;4;0;2;5;6;4;5];
[3;4;2;2;1;0;2;1;3;5;4;5;7;2;7;2;3;4;3;6;8;4;3;4;4;8;8;6;9;3;3;6;3;4;8;7;9;8;5;5;7;5;4;6;4;7;5;5;8;9;7;7;5;8;6;5;7;7;5;9;8;5;9;3;4;3;7;5;5;5;9;9;3;4;3;4;7;7;7;5;2;4;6;4;1;2;5;2;7;7;5;0;3;5;3;6;4;5;4];
[2;3;1;1;1;4;1;5;6;4;2;1;2;6;1;5;7;6;1;7;5;6;5;5;8;5;7;4;6;4;7;4;5;3;6;9;8;9;7;4;7;6;6;4;8;9;9;7;6;8;8;8;5;9;8;7;7;7;5;4;4;4;5;3;7;9;9;5;7;6;9;7;2;5;3;6;5;3;4;3;6;7;3;1;6;6;7;7;1;3;0;6;0;3;5;4;0;1;0];
[4;5;3;1;6;4;6;6;2;6;2;3;1;7;1;1;5;6;2;1;4;6;6;2;3;2;7;8;7;3;4;7;4;6;8;6;3;3;6;6;5;4;7;4;5;9;9;7;4;4;9;5;6;4;5;6;8;8;9;6;5;8;4;5;7;6;3;5;5;8;6;8;6;5;2;7;6;8;5;2;4;5;4;5;7;5;5;3;6;3;3;5;4;2;5;2;6;2;0];
[5;5;4;3;0;0;0;2;5;3;1;6;0;3;1;7;3;6;1;2;5;8;2;6;4;8;5;3;8;3;3;4;4;3;3;9;9;3;6;5;6;9;4;5;4;9;4;9;8;5;5;7;6;4;4;8;7;7;8;9;6;3;7;3;8;9;5;3;5;7;3;3;2;4;2;6;6;4;7;8;7;5;1;1;5;6;5;3;6;2;3;2;6;4;2;3;0;3;1];
[3;2;0;4;4;5;4;6;6;3;3;0;5;7;2;6;7;2;6;4;7;6;7;7;4;4;5;3;8;5;6;8;7;3;5;7;3;4;7;4;8;4;4;3;3;5;8;4;5;8;7;3;5;9;6;6;4;7;3;7;8;4;5;6;5;8;4;6;3;7;2;8;3;7;5;2;3;5;8;1;5;2;6;4;5;4;7;4;4;5;4;5;1;1;4;1;0;5;0];
[5;0;4;2;3;3;4;2;3;0;0;2;6;3;1;3;1;3;5;4;2;6;1;7;2;3;7;3;3;3;6;5;4;6;4;6;3;4;4;8;3;6;5;3;4;8;8;8;4;9;3;8;8;5;7;9;6;4;5;3;7;4;3;9;8;9;5;7;5;8;2;6;8;6;3;7;2;7;1;7;1;2;2;5;2;3;5;3;4;3;5;2;0;3;3;1;5;1;5];
[5;5;0;0;5;1;4;6;6;3;2;5;2;4;5;3;5;2;3;2;1;6;6;1;2;5;5;7;4;2;2;8;4;4;7;9;4;5;7;7;9;8;3;5;8;7;5;3;5;8;7;4;7;6;5;3;5;7;8;3;9;8;7;3;7;4;5;7;6;5;3;3;8;3;2;8;3;1;1;6;6;2;5;4;2;1;2;1;0;1;3;4;2;0;4;3;2;1;5];
[1;0;3;4;0;4;0;6;3;1;4;0;0;4;2;6;6;3;2;6;7;7;1;1;6;6;8;7;5;2;4;3;5;2;4;5;4;4;3;6;6;5;5;3;3;8;4;9;6;6;6;8;3;4;6;7;4;5;6;5;4;7;9;7;4;7;8;6;5;7;6;5;8;8;4;4;3;3;2;6;2;1;2;7;3;2;4;0;2;4;1;3;3;4;1;2;4;5;3];
[5;0;2;2;1;0;2;5;0;3;3;5;3;5;6;3;1;2;2;5;3;4;3;7;1;3;4;8;3;7;4;3;3;4;7;5;5;7;9;4;7;9;7;8;4;9;5;7;9;8;3;8;7;3;8;4;6;3;9;7;9;5;5;4;2;4;3;3;2;2;3;8;4;5;3;1;7;1;1;7;7;3;2;5;2;4;5;3;1;0;4;2;6;6;3;1;5;2;1];
[1;2;0;4;2;3;2;0;3;4;2;5;4;4;3;3;2;5;2;5;1;4;7;2;2;3;6;2;5;3;4;4;2;8;6;4;5;4;7;6;9;9;8;3;9;8;4;4;8;8;9;5;6;8;4;4;9;8;3;3;8;3;6;5;3;8;3;4;6;8;7;5;5;7;4;3;3;4;2;4;4;3;6;6;6;6;0;0;6;6;1;1;1;4;1;0;5;0;0];
[1;5;0;1;5;3;0;2;4;0;1;4;6;5;1;4;4;5;3;6;1;6;5;5;4;4;6;7;2;2;5;2;6;6;6;2;2;2;3;4;3;4;7;5;4;3;4;5;4;9;7;9;6;6;3;6;9;3;5;8;2;7;2;7;4;4;7;7;7;5;3;3;6;6;1;2;7;7;6;7;7;6;1;6;3;5;1;2;6;4;1;4;3;0;4;4;3;3;3];
[3;0;5;0;4;3;0;2;0;5;3;4;5;1;6;5;5;5;7;2;3;6;2;5;6;1;3;7;5;7;8;3;6;6;4;7;2;4;3;4;3;4;7;5;8;5;4;6;6;5;2;2;3;6;8;3;3;4;3;2;7;6;6;3;6;3;7;4;5;6;4;8;5;7;5;2;5;2;7;6;5;6;7;0;6;3;6;3;3;4;4;2;3;0;2;0;1;3;1];
[3;2;4;3;4;1;4;1;0;3;5;0;2;3;3;0;0;6;4;1;4;7;6;2;7;4;6;2;3;4;7;3;4;4;2;7;7;6;2;5;8;2;5;6;5;4;2;6;8;8;7;2;6;3;2;8;5;2;2;7;4;8;4;5;7;2;2;7;3;6;6;5;7;1;4;5;7;2;1;1;4;1;3;4;6;3;6;1;0;6;0;1;3;0;2;0;0;0;3];
[0;2;4;2;0;0;4;1;0;4;4;5;4;5;4;5;2;1;6;6;5;1;2;7;6;2;5;2;1;5;7;5;5;8;3;2;2;7;6;5;4;7;6;6;7;7;5;4;3;4;5;2;4;6;8;2;3;8;3;5;6;2;8;6;2;4;4;2;5;2;7;2;3;5;7;3;3;3;4;3;6;3;5;5;2;0;5;2;1;3;1;4;1;0;2;3;4;1;1];
[0;4;2;5;3;1;4;3;4;2;2;0;2;0;5;4;3;1;2;1;3;2;1;5;4;1;7;4;6;4;6;5;2;2;7;4;5;5;7;8;7;2;4;8;6;7;5;3;6;5;2;8;5;4;7;2;5;5;2;2;2;6;4;7;2;5;4;4;7;1;4;6;4;1;7;7;3;7;5;4;4;3;4;1;3;0;5;6;2;0;0;2;1;3;3;2;4;4;2];
[0;0;0;3;4;4;2;0;3;0;5;4;3;0;3;4;1;4;3;3;2;2;4;7;5;1;1;5;5;2;4;4;1;7;6;5;3;4;4;4;8;4;2;3;3;6;3;3;2;7;4;7;5;3;6;8;8;6;4;6;7;4;5;4;4;4;3;7;5;1;5;5;5;4;7;3;6;3;2;2;3;6;5;6;0;4;6;6;2;3;5;4;1;0;2;1;3;1;2];
[1;1;2;2;0;1;1;0;1;4;4;0;0;5;1;6;5;0;1;2;3;6;6;6;5;5;2;7;6;3;7;5;1;1;7;4;4;1;4;5;2;2;5;2;2;4;5;4;3;6;7;6;2;2;5;8;6;8;4;6;7;3;8;6;7;2;4;5;5;2;5;5;3;4;1;2;3;3;2;1;3;1;4;1;3;1;3;6;4;4;3;0;2;2;0;3;5;3;4];
[0;3;3;0;3;4;2;3;5;5;4;1;2;0;6;0;2;6;5;6;5;6;1;1;3;3;1;5;5;7;4;7;7;4;1;3;6;3;5;3;3;2;2;4;3;3;3;4;8;6;6;4;8;3;2;3;3;6;4;6;1;3;1;4;2;7;3;6;3;5;1;6;5;2;7;7;4;6;6;4;0;1;3;0;0;5;3;3;2;4;1;0;5;4;4;1;3;4;3];
[4;4;0;4;3;2;2;3;5;5;2;4;0;1;5;3;2;4;2;2;4;6;2;0;6;4;1;6;3;1;1;1;1;4;3;6;5;7;5;7;6;1;7;6;6;4;3;7;8;6;5;5;5;7;6;5;3;2;6;5;4;1;4;6;6;5;2;2;7;1;3;2;2;7;2;1;2;3;0;4;1;5;3;6;2;2;1;4;0;2;5;2;5;0;0;4;4;2;0];
[4;2;4;2;0;4;4;1;5;0;2;5;3;0;4;3;4;4;2;1;0;1;4;4;5;1;1;3;3;6;1;2;6;1;7;1;3;5;2;7;3;3;2;3;4;2;5;7;6;4;7;4;1;4;1;6;3;5;5;5;2;5;5;7;7;6;6;6;2;3;1;3;5;1;2;4;4;5;1;2;4;6;1;4;5;1;2;5;4;1;5;5;2;3;1;1;4;0;3];
[2;0;1;2;0;3;4;4;3;4;1;3;3;3;1;0;4;4;1;1;2;6;4;3;0;0;6;5;4;6;6;7;6;7;3;1;3;6;2;4;5;4;1;4;7;4;1;5;6;1;3;6;7;5;3;2;4;3;1;5;2;2;2;1;3;5;1;5;4;6;2;2;4;5;0;0;3;4;4;2;4;1;0;5;1;1;0;2;2;4;3;4;5;2;0;4;4;2;4];
[4;0;4;0;3;2;4;2;0;0;4;5;4;0;0;0;4;4;0;5;2;5;6;5;5;1;5;1;6;2;4;0;1;3;2;6;2;6;2;6;6;4;1;2;3;5;7;1;3;3;3;1;3;1;3;5;6;2;2;5;6;3;6;4;2;1;1;4;2;0;1;4;5;1;1;2;4;0;1;6;0;4;6;5;5;4;3;2;0;1;0;5;4;0;1;4;3;1;4];
[1;4;0;0;4;4;0;0;1;3;2;2;2;5;1;0;4;5;5;0;3;0;4;3;1;5;1;6;3;5;1;2;6;6;7;5;5;7;6;6;4;6;5;2;2;2;4;5;3;6;7;5;2;7;2;5;4;7;5;5;4;4;4;5;7;2;3;4;3;4;6;2;4;6;6;0;6;6;2;3;3;1;0;5;3;2;3;1;3;3;2;0;0;2;4;0;3;2;4];
[1;4;2;1;3;2;0;4;0;3;4;5;3;4;4;1;2;1;4;0;3;5;0;6;6;0;4;1;6;0;4;5;4;2;5;3;2;7;7;1;5;6;4;2;5;2;7;4;1;5;1;7;6;2;7;1;2;3;5;2;5;4;3;3;0;5;5;6;3;1;1;1;0;2;5;0;0;2;3;0;5;1;0;4;2;1;4;3;1;2;1;4;0;0;3;1;4;4;3];
[3;2;0;4;1;1;1;3;3;0;2;4;4;0;1;4;0;4;3;2;3;4;3;2;0;6;3;1;3;5;4;0;6;6;5;4;4;3;3;3;6;3;1;6;1;3;4;5;3;1;5;7;1;3;3;4;1;4;1;1;2;4;4;5;5;4;2;3;3;0;2;2;5;2;6;1;1;6;1;5;3;3;2;3;0;0;2;5;0;5;1;4;4;0;4;4;2;1;0];
[1;3;1;2;3;0;1;2;4;1;1;1;3;1;4;3;4;0;1;0;1;3;5;4;0;2;4;3;3;5;0;6;0;4;2;5;1;0;0;3;1;2;3;4;5;4;4;4;1;7;5;7;1;6;4;3;3;1;3;5;3;2;3;0;2;1;5;5;1;4;3;5;4;2;5;3;1;3;1;2;4;5;5;4;0;1;2;3;2;1;0;2;3;3;0;0;3;2;4];
[0;3;0;4;2;0;1;1;4;0;2;1;2;1;5;4;0;2;1;2;1;3;0;3;1;3;3;1;1;4;5;4;6;2;2;0;2;1;4;6;0;4;2;0;2;3;3;2;1;3;6;0;2;2;3;5;0;2;6;0;4;6;2;6;0;6;4;4;6;5;0;2;4;3;0;0;5;2;0;0;2;1;5;0;1;4;4;4;4;4;3;2;1;1;0;4;2;0;3];
[3;0;0;2;1;1;4;1;4;2;4;3;4;1;4;5;0;0;0;4;4;0;5;0;1;0;4;1;0;2;0;3;4;5;2;5;4;6;2;3;5;5;3;6;6;6;5;2;5;2;3;2;0;4;1;6;3;6;2;4;0;2;6;4;4;3;1;0;2;2;0;3;5;5;1;5;1;3;3;3;1;4;1;4;1;0;1;1;4;3;3;1;0;4;0;3;0;2;3];
[1;1;0;2;1;1;2;3;0;3;4;3;2;0;4;1;1;4;1;4;2;5;0;0;2;4;0;3;5;3;2;0;0;4;3;4;2;4;3;1;5;6;5;5;4;2;1;5;0;2;3;4;3;0;2;3;3;0;6;4;6;1;0;5;3;1;3;1;6;0;1;5;1;1;0;2;0;2;4;4;0;2;4;1;0;0;3;2;3;1;2;3;4;1;1;3;2;0;2];
[1;0;0;2;0;2;0;1;3;2;3;3;0;3;4;3;1;4;5;4;0;2;2;0;4;4;0;2;2;2;2;5;2;0;6;6;4;5;1;4;6;5;2;0;3;5;4;2;4;5;3;5;3;5;6;1;1;3;4;6;0;0;1;1;4;6;5;2;6;0;4;5;3;4;2;1;4;2;0;1;3;3;0;5;3;3;1;4;2;1;4;1;1;4;1;0;0;1;3];
[2;1;3;1;2;0;2;0;2;2;0;3;1;3;1;3;3;4;3;5;4;1;3;3;5;5;0;4;1;1;1;3;0;0;5;0;0;6;3;0;6;0;3;4;4;5;6;1;4;2;6;4;6;2;1;5;1;3;5;1;2;6;1;2;3;6;1;2;3;3;0;1;3;1;5;4;1;5;3;2;4;4;0;4;1;0;0;1;4;0;4;0;3;2;1;1;3;1;3]
].

Search (N -> N -> N).

Fixpoint forward_vis' (m : N) (l : list N) : list bool :=
  match l with
  | nil => nil
  | h :: r => (m <? h) :: forward_vis' (N.max h m) r
  end.

Definition forward_vis (l : list N) : list bool :=
  match l with
  | nil => nil
  | h :: r => true :: forward_vis' h r
  end.

Definition backward_vis (l : list N) : list bool :=
  rev (forward_vis (rev l)).

Definition grid_or (l1 l2 : list (list bool)) : list (list bool) :=
  map (fun il => let (il1,il2) := il : (list bool*list bool) in map (fun bp => let (b1,b2) := bp : (bool*bool)in orb b1 b2) (combine il1 il2)) (combine l1 l2).

Fixpoint deop {A} (l : list (option A)) : list A :=
  match l with
  | nil => nil
  | None :: r => deop r
  | (Some a) :: r => a :: deop r
  end.

Fixpoint transpose' {A} (n : nat) (l : list (list A)) : list (list A) :=
  match n with
  | O => nil
  | S n =>
    let fsts := deop (map (fun ll => hd_error ll) l) in 
    let tls := map (fun ll => tl ll) l in
    fsts :: transpose' n tls
  end.

Definition transpose {A} (l : list (list A)) : list (list A) :=
  transpose' (length (hd nil l)) l.

Definition vis (i : list (list N)) :=
  let fwd := map forward_vis i in
  let bck := map backward_vis i in
  let up := transpose (map forward_vis (transpose i)) in
  let dwn := transpose (map backward_vis (transpose i)) in
  grid_or (grid_or fwd bck) (grid_or up dwn).

Definition impl_1 (i : (list (list N))) :=
  list_sum (map (fun l => length (filter id l)) (vis i)).

Example test1 : impl_1 test_in = 21%nat. Proof. vm_compute. reflexivity. Qed.

Compute (impl_1 input).

Fixpoint forward_cnt' (m : N) (l : list N) : N :=
  match l with
  | nil => 0
  | h :: r => if (m <=? h) then 1 else 1 + forward_cnt' m r
  end.

Fixpoint forward_cnt (l : list N) : list N :=
  match l with
  | nil => nil
  | h :: r => forward_cnt' h r :: forward_cnt r
  end.

Definition backward_cnt (l : list N) : list N :=
  rev (forward_cnt (rev l)).

Definition grid_prod (l1 l2 : list (list N)) : list (list N) :=
  map (fun il => let (il1,il2) := il : (list N*list N) in map (fun bp => let (b1,b2) := bp : (N*N)in b1*b2) (combine il1 il2)) (combine l1 l2).

Definition cnt (i : list (list N)) :=
  let fwd := map forward_cnt i in
  let bck := map backward_cnt i in
  let up := transpose (map forward_cnt (transpose i)) in
  let dwn := transpose (map backward_cnt (transpose i)) in
  grid_prod (grid_prod fwd bck) (grid_prod up dwn).

Fixpoint nmax' (m : N) (l : list N) :=
  match l with
  | nil => m
  | a :: r => nmax' (N.max a m) r
  end.

Definition nmax (l : list N) :=
  match l with
  | nil => 0
  | a :: r => nmax' a r
  end.

Definition impl_2 (i : (list (list N))) :=
  nmax (map (fun l => nmax l) (cnt i)).

Example test2 : impl_2 test_in = 8. Proof. vm_compute. reflexivity. Qed.

Compute (impl_2 input).